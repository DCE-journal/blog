<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Adrian Clifton">
<meta name="dcterms.date" content="2022-06-22">
<meta name="description" content="Adrian Clifton (HiLo) explains why data sharing in the maritime industry is critical.">

<title>Working Together for Safer Seas – DCE-blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-48e5140a7aed9f2ea8f32f5f899b1cae.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/DCE-mod.png" alt="" class="navbar-logo light-content">
    <img src="../../images/DCE-mod.png" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">DCE-blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://uk.linkedin.com/company/data-centric-engineering/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Working Together for Safer Seas</h1>
                  <div>
        <div class="description">
          Adrian Clifton (HiLo) explains why data sharing in the maritime industry is critical.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Translational</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Adrian Clifton </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 22, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><em>This blog offers informed opinions and perspectives relating to nascent technologies in data-centric engineering. <a href="https://www.linkedin.com/in/adrianclifton/?originalSubdomain=uk">Adrian Clifton</a> (<a href="https://www.hilomrm.com/">HiLo</a>) explains why data sharing in the maritime industry is critical to accurately predict and prevent high-impact incidents, saving time, money and lives.</em></p>
<hr>
<p>The world is more connected than ever before, thanks to the Internet and intelligent technology powered by it. From 2010–2016 there were on average 640,000 people online for the first time every day: an extra 27,000 every hour. Things have only accelerated since then, with the growth of mobile 4G and 5G data: between April 2020 and April 2021, more than 330 million more people gained online access.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="venti-views-1cqIcrWFQBI-unsplash.jpg" class="img-fluid figure-img"></p>
<figcaption>Photo by Venti Views on Unsplash</figcaption>
</figure>
</div>
<section id="the-rise-of-information-sharing-worldwide" class="level1">
<h1>The rise of information sharing worldwide</h1>
<p>Not only is access to information growing, but the amount, quality and depth of that data is also increasing. The Internet offers solutions to almost every issue. Almost every possible query has already been asked, and the answer is available at a click of a button.</p>
<p>Information is also available through many different methods, such as:</p>
<ol type="1">
<li><p>Reading blogs</p></li>
<li><p>Searching through social channels</p></li>
<li><p>Watching video-sharing platforms</p></li>
<li><p>Browsing web pages for specific areas of interest</p></li>
</ol>
<p>The growth of connected devices — ‘The Internet of Things’ — means that people don’t even have to search for the answers. This is because machine learning, a form of artificial intelligence (AI) and computer science, can now be used by machines to imitate the way that humans learn through experience.</p>
<p>This allows them to:</p>
<ol type="1">
<li><p>Improve their future performance without needing new data to be entered manually</p></li>
<li><p>Solve issues and surpass obstacles by connecting systems that had no way of communicating before</p></li>
</ol>
<p>Industries such as aerospace, rail and nuclear energy are prime examples of how this technology benefits organisations. With airlines, for example, this connectivity can:</p>
<ul>
<li>Help avoid delays</li>
<li>Detect technical issues through machine learning, and predict- where repairs will be needed in the future</li>
<li>Quickly source new components when they are needed</li>
<li>Make flight routes faster and safer</li>
</ul>
<p>The knowledge all this data generates creates new opportunities for improvement across every industry. How can mariners and maritime organisations use this immensely powerful data to improve our operations?</p>
</section>
<section id="an-increasingly-connected-maritime-industry" class="level1">
<h1>An increasingly connected maritime industry</h1>
<p>The marine sector is greatly increasing its use of automation and data sharing. This decreases the need for marine personnel to perform tasks manually, and in turn, reduces human error. This is a crucial safety improvement for the industry. Gathering data through technology is faster, simpler, more accurate and provides future-proofing (as connected equipment learns best practices and improves delivery).</p>
<p>Potential marine safety risks (especially rare ones) have traditionally been very challenging to anticipate. However, if a mariner needing to solve a problem with a piece of shipping equipment has access to connected technology, they can access real-life data and experience to see if anyone else has experienced the same issue; and more importantly how to solve it. Even if they cannot discover the exact solution, they have additional data to help them troubleshoot the problem.</p>
</section>
<section id="sharing-is-caring-for-all" class="level1">
<h1>Sharing is caring for all</h1>
<p>Collecting and using this information within your organisation is one thing. However, far greater benefits will be achieved by improving safety and efficiency across the whole industry. In order to achieve this, data must be shared and collated. This greater volume of information provides much more accurate predictions.</p>
<p>Happily, the maritime industry is starting to work more closely together by building relationships, communication and connectivity, in order to make the most of the hugely valuable information resources available. For example, technology can utilise real-life experience from seafarers themselves. Information can be gained, input and shared on how previous fixes have been identified and applied, and how these can be used in the future. By sharing this data, human error can be reduced and solutions can be fed back to prevent incidents in the future.</p>
</section>
<section id="the-big-environmental-question" class="level1">
<h1>The big environmental question</h1>
<p>Many different groups within the maritime industry are driving this connectivity. The aim is to achieve industry-wide improvements in key areas including:</p>
<ul>
<li>Improving and managing safety</li>
<li>Increasing efficiency</li>
<li>Perhaps the most important and challenging item on the agenda: environmental impact</li>
</ul>
<p>A connected industry brings benefits in many areas:</p>
<ul>
<li>Improved safety and efficiency of maritime operations for all, due to fewer incidents on the seas</li>
<li>Equipment driven by connected technology is less likely to develop faults, meaning industry professionals are freed up to drive businesses forward</li>
<li>Saving time and money in these areas allows you to focus on new challenges</li>
</ul>
<p>Environmental improvements are obviously a very high priority and will only become more so. Industry conversations on how to respond are critical.</p>
<p>Data connectivity can play a huge part by demonstrating the impact of new technologies and techniques such as:</p>
<ul>
<li>More efficient fuel types</li>
<li>Fuel management optimisation techniques</li>
<li>Upgrades of navigation systems to keep ships at sea longer</li>
<li>Dual-fuel engines that can use LNG (liquefied natural gas) or marine diesel fuel</li>
<li>Future environmentally-friendly fuels when they emerge</li>
</ul>
</section>
<section id="a-connected-maritime-future-is-a-better-one" class="level1">
<h1>A connected maritime future is a better one</h1>
<p>The more knowledge both mariners and their assistive technology have of potential scenarios and how to solve them, the lower the risk of errors when managing them. By continuing to build connectivity and share data within the industry, professionals and organisations can learn from each other to improve life for everyone on the seas — from efficiency to safety to environmental improvements.</p>
<p>The more connected the industry becomes, the safer seafarers will be. The more that high volumes of data from different vessels, scenarios and organisations are shared and analysed in a single place, the more accurately high-impact incidents can be predicted.</p>
</section>
<section id="building-a-decision-making-system-for-maritime-safety" class="level1">
<h1>Building a decision-making system for maritime safety</h1>
<p>However, this is not at all easy to achieve. Shipping companies have traditionally been very reluctant to share safety data, for both commercial sensitivity and reputational reasons. This means publicly available data for the industry is very limited. As noted above, to make a big data approach effective you need not only a wide variety of data, but a significant amount of it. This is because:</p>
<ul>
<li>You need a sufficient volume of data for patterns and trends to emerge and be verifiable</li>
<li>The greater amount of data you have, the better chance you have of finding the unusual, unexpected information that can be a critical game-changer for your approach</li>
</ul>
<p>The answer lies in pulling this data together into a single independent source, and maritime technology company HiLo has done just this. They have created the industry’s first big-data-driven decision-making system, combining info from over 4,000 vessels with world-leading statistical analysis.</p>
<p>The data have been anonymised, therefore ensuring company reputations are protected and providing them with greater encouragement to share it. This has broken the largest barrier to data sharing, demonstrated by the fact that those 4,000 vessels are drawn from more than 55 competing shipping companies, who would never have been comfortable sharing such information previously.</p>
<p>Advantages include:</p>
<ul>
<li>The dataset is large in both volume and scope, coming as it does from sources including incident management systems, audits and equipment</li>
<li>It can be used to generate expert fleet risk analysis, presented clearly through simple, customised dashboards that highlight the biggest risks</li>
<li>Therefore maritime companies can prioritise budget and resources effectively to make the most important safety changes to protect crews and vessels across the seas</li>
</ul>
</section>
<section id="safety-success-on-the-seas" class="level1">
<h1>Safety success on the seas</h1>
<p>The success of this decision-making system has been outstanding. 2021 figures saw a massive yearly improvement for the companies whose vessels are part of the HiLo fleet. Highlights included:</p>
<ul>
<li>£3 million cost reduction from issues prevented or mitigated early</li>
<li>12% reduction in actual/potential high-impact incidents across the fleet</li>
<li>8% reduction in serious injuries to crew members across the fleet</li>
<li>5% reduction in major spills across the fleet</li>
<li>308 fewer actual/potential high-impact incidents for tankers</li>
<li>135 fewer actual/potential high-impact incidents for bulk carriers</li>
</ul>
</section>
<section id="better-together" class="level1">
<h1>Better together</h1>
<p>It can be seen, then, that maritime companies simply cannot make quantum leaps in safety on their own. The amount and range of data from even a large individual organisation in isolation will not compare to what can be achieved together. To protect the industry through its ever-changing challenges, data sharing is critical.</p>
<hr>
<p><strong>Competing Interest:</strong> Adrian Clifton writes for HiLo, a maritime safety decision-support company which works to save time, money, and lives at sea through data analysis.</p>
<p><strong>Keywords:</strong> Maritime Safety; Marine Risk Management; Decision Support; Technology</p>
<hr>
<p><em>This is the blog for <a href="https://www.cambridge.org/core/journals/data-centric-engineering">Data-Centric Engineering</a>, an open-access journal published by Cambridge University Press and supported by the Lloyd’s Register Foundation. You can also find us on <a href="https://www.linkedin.com/company/data-centric-engineering/">LinkedIn</a> and <a href="https://x.com/dce_journal?s=21&amp;t=UlVCTdhrJw2BrdGzFkG5AA">X</a>. <a href="https://www.cambridge.org/core/journals/data-centric-engineering/information/instructions-for-authors">Here are instructions</a> for submitting an article to the journal.</em></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/DCE-journal\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>